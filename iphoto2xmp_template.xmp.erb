<?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2">
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about=""
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
    xmlns:acdsee="http://ns.acdsee.com/iptc/1.0/"
    xmlns:digiKam="http://www.digikam.org/ns/1.0/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:exif="http://ns.adobe.com/exif/1.0/"
    xmlns:video="http://www.video/"
    xmlns:MicrosoftPhoto="http://ns.microsoft.com/photo/1.0/"
    xmlns:mwg-rs="http://www.metadataworkinggroup.com/schemas/regions/"
    xmlns:stArea="http://ns.adobe.com/xmp/sType/Area#"
    xmlns:MP="http://ns.microsoft.com/photo/1.2/"
    xmlns:MPRI="http://ns.microsoft.com/photo/1.2/t/RegionInfo#"
    xmlns:MPReg="http://ns.microsoft.com/photo/1.2/t/Region#"
    xmlns:lr="http://ns.adobe.com/lightroom/1.0/"
    xmlns:mediapro="http://ns.iview-multimedia.com/mediapro/1.0/"
    xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/"
   xmp:CreatorTool="iphoto2xmp.rb by Jens Benecke"
   xmp:MetadataDate="<%= @date_meta %>"
   xmp:Rating="<%= @rating %>"
   xmp:CreateDate="<%= @date_taken %>"
   xmp:ModifyDate="<%= @date_modified %>"
   acdsee:rating="<%= @rating %>"
   acdsee:caption="<%= @caption %>"
   acdsee:notes="<%= @description %>"
   digiKam:ImageUniqueID="<%= @uuid %>"
   digiKam:PickLabel="<%= @hidden %>"
   digiKam:ColorLabel="<%= @flagged %>"
   exif:DateTimeOriginal="<%= @date_taken %>"
   exif:DateTimeDigitized="<%= @date_imported %>"
   exif:ExifVersion="0221"
   exif:GPSLatitudeRef="N"
   exif:GPSLongitudeRef="E"
   exif:GPSVersionID="2.0.0.0"
   video:DateTimeOriginal="<%= @date_taken %>"
   video:ModificationDate="<%= @date_modified %>"
<% if !!@latitude %>
   exif:GPSLatitude="<%= @latitude %>"
   exif:GPSLongitude="<%= @longitude %>"
   exif:GPSMapDatum="WGS-84"
<% end %>
<% if !!@gpscity %>
   photoshop:City="<%= @gpscity %>"
<% end %>
<% if !!@gpsstate %>
   photoshop:State="<%= @gpsstate %>"
<% end %>
<% if !!@gpscountryname %>
   photoshop:Country="<%= @gpscountryname %>"
<% end %>
<% if !!@gpslocation %>
   Iptc4xmpCore:Location="<%= @gpslocation %>"
<% end %>
<% if !!@gps3lettercountrycode %>
   Iptc4xmpCore:CountryCode="<%= @gps3lettercountrycode %>"
<% end %>
  >

<% if @caption %>
   <dc:title>
    <rdf:Alt>
     <rdf:li xml:lang="x-default"><%= @caption %></rdf:li>
    </rdf:Alt>
   </dc:title>
<% end %>

<% unless @keylist.empty? %>
   <digiKam:TagsList>
    <rdf:Seq>
     <% for keyword in @keylist %>
      <rdf:li><%= keyword %></rdf:li>
     <% end %>
    </rdf:Seq>
   </digiKam:TagsList>
   <MicrosoftPhoto:LastKeywordXMP>
    <rdf:Bag>
     <% for keyword in @keylist %>
      <rdf:li><%= keyword %></rdf:li>
     <% end %>
    </rdf:Bag>
   </MicrosoftPhoto:LastKeywordXMP>
   <lr:hierarchicalSubject>
    <rdf:Bag>
     <% for keyword in @keylist %>
      <rdf:li><%= keyword %></rdf:li>
     <% end %>
    </rdf:Bag>
   </lr:hierarchicalSubject>
   <mediapro:CatalogSets>
    <rdf:Bag>
     <% for keyword in @keylist %>
      <rdf:li><%= keyword %></rdf:li>
     <% end %>
    </rdf:Bag>
   </mediapro:CatalogSets>
   <dc:subject>
    <rdf:Bag>
     <% for keyword in @keylist %>
      <rdf:li><%= keyword %></rdf:li>
     <% end %>
    </rdf:Bag>
   </dc:subject>
<% end %>

<% if @description %>
   <tiff:ImageDescription>
    <rdf:Alt>
     <rdf:li xml:lang="x-default"><%= @description %></rdf:li>
    </rdf:Alt>
   </tiff:ImageDescription>
   <exif:UserComment>
    <rdf:Alt>
     <rdf:li xml:lang="x-default"><%= @description %></rdf:li>
    </rdf:Alt>
   </exif:UserComment>
   <dc:description>
    <rdf:Alt>
     <rdf:li xml:lang="x-default"><%= @description %></rdf:li>
    </rdf:Alt>
   </dc:description>
<% end %>

<% if @faces.is_a?(Array) and !@faces.empty? %>

<!--  Not required for Digikam and creates duplicate face tags, so disabled for now.
   <mwg-rs:Regions rdf:parseType="Resource">
    <mwg-rs:RegionList>
     <rdf:Bag>
<% for face in @faces %>
       <rdf:li>
        <rdf:Description
         mwg-rs:Name="<%= face['name'] %>"
         mwg-rs:Type="Face">
         <mwg-rs:Area
          stArea:x="<%= face['centerx'] %>"
          stArea:y="<%= face['centery'] %>"
          stArea:w="<%= face['width'] %>"
          stArea:h="<%= face['height'] %>"
          stArea:unit="normalized"/>
        </rdf:Description>
       </rdf:li>
<% end %>
     </rdf:Bag>
    </mwg-rs:RegionList>
   </mwg-rs:Regions>
-->

   <MP:RegionInfo rdf:parseType="Resource">
    <MPRI:Regions>
     <rdf:Bag>
<% for face in @faces %>
      <rdf:li
       MPReg:Rectangle="<%= face['topleftx'] %>, <%= face['toplefty'] %>, <%= face['width'] %>, <%= face['height'] %>"
       MPReg:PersonDisplayName="<%= face['name'] %>"/>
<% end %>
     </rdf:Bag>
    </MPRI:Regions>
   </MP:RegionInfo>
<% end %>

   <dc:creator>
    <rdf:Seq>
     <rdf:li><%= @creator %></rdf:li>
    </rdf:Seq>
   </dc:creator>
  </rdf:Description>
 </rdf:RDF>
</x:xmpmeta>
<?xpacket end="w"?>

